---
import { getCollection } from "astro:content";
import Footer from "../../components/Footer.astro";
import Head from "../../components/Head.astro";
import Navbar from "../../components/Navbar.astro";

export async function getStaticPaths() {
	const posts = await getCollection('posts');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();

const formattedDate = post.data ? new Intl.DateTimeFormat('en-US', { dateStyle: 'full' }).format(new Date(post.data.date)) : '';

---


<!DOCTYPE html>
<html lang="en">
    <Head>
        <link rel="stylesheet" href="/styles/blog.css"/>
    </Head>

    <body>

        <Navbar/>

        <div style="width: 20px; height:6rem;">
        </div>

        <!--  Body  -->
        <section class="mainn" style="margin: 0 auto; max-width: 1100px;">
            <section class="blog-header" style="width:100%;"> 
                
            <h1 class="mBlogTitle">
             {post.data.title}
            </h1>

            <img class="mBlogImg" 
            src={post.data.imageUrl}
            style="width:100%;height: 240px; margin: 0 auto;object-fit: cover;">
            
            <div class="blog-meta"> 
                <small class="mBlogAuthor">Author : {post.data.author}</small>
                <small class="mBlogDate">&nbsp;&nbsp;&nbsp;Date: {formattedDate}</small>
                <small  class="mBlogRead">&nbsp;&nbsp;&nbsp;{post.data.readTime} read</small>
            </div>
        </section>



        <!--  Table of content -->
        <section class="toc">
            <h2>Table of contents</h2>
            <ul id="tableOfContents">
                {
                    post.data.tableOfContent.split(',').map((data)=> {
                        return <li>{data}</li>
                    })
                }
            </ul>
        </section>



        <!-- Main Blog Post -->
        <Content/>

        <!--    
            <div class="newsletter-box">
                <h2>Subscribe to Our Newsletter</h2>
                <p>Get the latest news and updates delivered to your inbox.</p>
                <form>
                    <input type="email" placeholder="Enter your email" required>
                    <button type="submit">Subscribe</button>
                </form>
            </div>
         -->
    </section>

    <Footer/>
    <script src="/js/main.js" is:inline></script>
</body>
</html>

